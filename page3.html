<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA Test Report - MotorParts Management System (Page 3)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f7; color: #1f2933; line-height: 1.6; }
        .container { max-width: 1220px; margin: 0 auto; padding: 24px 28px; }
        
        /* Header */
        .header { background: #2c5282; color: white; padding: 30px; border-radius: 12px; margin-bottom: 18px; }
        .header h1 { font-size: 28px; margin-bottom: 5px; }
        .header p { opacity: 0.9; font-size: 14px; }
        
        /* Simple nav between report pages */
        .report-nav { display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 22px; font-size: 13px; color: #4b5563; }
        .report-nav a { color: #2563eb; text-decoration: none; padding: 4px 10px; border-radius: 999px; border: 1px solid transparent; }
        .report-nav a:hover { background: #eff6ff; border-color: #bfdbfe; }
        .report-nav .active { background: #1d4ed8; color: #f9fafb; border-color: #1d4ed8; cursor: default; }
        
        /* Sections */
        .section { background: white; border-radius: 12px; margin-bottom: 20px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .section-header { padding: 15px 20px; background: #f8fafc; border-bottom: 1px solid #e2e8f0; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .section-header:hover { background: #edf2f7; }
        .section-header h2 { font-size: 16px; color: #2d3748; }
        .section-header .badge { padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge.pass { background: #c6f6d5; color: #276749; }
        .badge.fail { background: #fed7d7; color: #c53030; }
        .badge.warn { background: #fefcbf; color: #975a16; }
        .badge.skip { background: #e2e8f0; color: #4a5568; }
        .section-content { padding: 20px; display: none; }
        .section-content.active { display: block; }
        
        /* Bug Report */
        .bug-card { background: #fff5f5; border-left: 4px solid #e53e3e; padding: 15px 20px; margin-bottom: 15px; border-radius: 0 8px 8px 0; }
        .bug-card.minor { background: #fffff0; border-left-color: #d69e2e; }
        .bug-card h4 { color: #c53030; margin-bottom: 8px; font-size: 15px; }
        .bug-card.minor h4 { color: #975a16; }
        .bug-card p { font-size: 13px; color: #4a5568; margin-bottom: 5px; }
        .bug-card .severity { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-left: 10px; }
        .severity.high { background: #fed7d7; color: #c53030; }
        .severity.medium { background: #fefcbf; color: #975a16; }
        .severity.low { background: #bee3f8; color: #2b6cb0; }
        
        /* Footer */
        .footer { text-align: center; padding: 20px; color: #718096; font-size: 13px; }
        
        /* Collapsible */
        .chevron { transition: transform 0.3s; }
        .section-header.open .chevron { transform: rotate(180deg); }
        
        /* Lightbox */
        .report-img { cursor: pointer; }
        .lightbox-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 9999; padding: 20px; box-sizing: border-box; }
        .lightbox-overlay.active { display: flex; }
        .lightbox-overlay img { max-width: 95vw; max-height: 95vh; object-fit: contain; border-radius: 8px; box-shadow: 0 4px 24px rgba(0,0,0,0.4); }
        .lightbox-overlay .lightbox-close { position: absolute; top: 16px; right: 24px; color: white; font-size: 32px; cursor: pointer; line-height: 1; opacity: 0.9; }
        .lightbox-overlay .lightbox-close:hover { opacity: 1; }
        
        /* Print Styles */
        @media print {
            .section-content { display: block !important; }
            .header { break-inside: avoid; }
            .section { break-inside: avoid; }
            .lightbox-overlay { display: none !important; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>QA Test Report – Page 3</h1>
            <p>MotorParts Inventory & POS Management System</p>
            <p>This page is for the third round of QA testing and regression checks after fixes from Page 2.</p>
        </div>

        <!-- Navigation between pages -->
        <div class="report-nav">
            <a href="index.html">Page 1 – Original Report</a>
            <a href="page2.html">Page 2 – Next QA Cycle</a>
            <a href="page3.html" class="active">Page 3 – Post-Fix Regression</a>
        </div>
        
        <!-- Bug Summary (start blank for this cycle) -->
        <div class="section">
            <div class="section-header open" onclick="toggleSection(this)">
                <h2>Bugs Found (4 Issues So Far)</h2>
                <span class="badge fail">Action Required</span>
                <svg class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
            </div>
            <div class="section-content active">
                <p style="font-size: 13px; color: #4a5568; margin-bottom: 12px;">
                    Use this section to log any bugs or regressions found during the third QA cycle. Follow the same bug card
                    format (IDs continuing from BUG-019) so numbering stays chronological across all pages.
                </p>

                <div class="bug-card">
                    <h4>BUG-019: Inventory Edit Always Shows &quot;Failed to save product: true&quot; <span class="severity high">High</span></h4>
                    <p><strong>Location:</strong> Admin → Inventory → Edit Product modal</p>
                    <p><strong>Steps:</strong> Log in as Admin → Go to <em>Inventory</em> → Click the edit icon for any product → Change any field (name, stock, prices, or low stock alert) → Click <em>Save Product</em>.</p>
                    <p><strong>Expected:</strong> When the edit is valid, the product should save successfully, the modal should close or show a clear success message, and the list should reflect the updated values. Only invalid edits should show an error message that explains what is wrong.</p>
                    <p><strong>Actual:</strong> Regardless of what is edited, clicking <em>Save Product</em> triggers a browser alert saying <code>Failed to save product: true</code>. The message is confusing (boolean shown instead of a real reason) and suggests a failure, even if the UI later reflects some changes.</p>
                    <p><strong>Impact:</strong> Admins cannot trust whether inventory edits were actually saved or not, and the error message gives no actionable information. This can lead to repeated edits, inconsistent data, or missed corrections.</p>
                    <p><strong>Recommendation:</strong> Fix the save endpoint or client logic so it only shows an error dialog when the save truly fails, and replace the generic boolean message with a clear explanation. On success, either show a success toast or simply close the modal and update the list without any error popup.</p>
                    <p style="margin-top: 10px;"><strong>Preview:</strong> Inventory Edit Product screen showing the error alert &quot;Failed to save product: true&quot; after attempting to save changes.</p>
                    <div style="display: flex; justify-content: center; margin-top: 6px;">
                        <div style="flex: 1 1 260px; max-width: 560px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">Inventory → Edit Product: confusing failure alert on save</p>
                            <img class="report-img" src="sc/edit_fail.png" alt="Inventory Edit Product modal with a browser alert saying Failed to save product: true when attempting to save changes" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                    </div>
                </div>

                <div class="bug-card">
                    <h4>BUG-020: Wholesale Orders Do Not Decrease Product Stock <span class="severity high">High</span></h4>
                    <p><strong>Location:</strong> Admin / Manager → Whole Sale → Create Wholesale Order</p>
                    <p><strong>Steps:</strong> Log in as Admin or Manager → Go to <em>Whole Sale</em> → Select a product that has existing stock → Place a wholesale order for some quantity → Complete the order (see &quot;Wholesale order complete&quot; confirmation) → Check the product’s stock in <em>Inventory</em>.</p>
                    <p><strong>Expected:</strong> After a wholesale order is completed, the ordered quantity should be deducted from the product’s stock so Inventory reflects the reduced on-hand quantity.</p>
                    <p><strong>Actual:</strong> Even after &quot;Wholesale order complete&quot; is shown, the product’s stock count in Inventory does not decrease—the quantity ordered via Wholesale is not subtracted from the stock.</p>
                    <p><strong>Impact:</strong> Inventory becomes inaccurate whenever Wholesale is used, leading to overstated stock and potential overselling because wholesale movements are not reflected in the main inventory count.</p>
                    <p><strong>Recommendation:</strong> Ensure the Wholesale completion flow updates inventory in the same way as Sales Out—subtract the ordered quantity from stock for the appropriate branch and record the movement in History for audit.</p>
                    <p style="margin-top: 10px;"><strong>Preview:</strong> Wholesale order flow showing a completed order while the product’s stock count remains unchanged.</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-top: 6px;">
                        <div style="flex: 1 1 260px; max-width: 360px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">1. Selecting product and quantity in Wholesale</p>
                            <img class="report-img" src="sc/wholesale_1.png" alt="Wholesale screen showing selection of product and quantity for order" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                        <div style="flex: 1 1 260px; max-width: 360px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">2. Wholesale order summary / completion</p>
                            <img class="report-img" src="sc/wholesale_2.png" alt="Wholesale order summary indicating order completion" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                        <div style="flex: 1 1 260px; max-width: 360px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">3. Inventory stock count unchanged after Wholesale</p>
                            <img class="report-img" src="sc/wholesale_3.png" alt="Inventory list showing product stock count unchanged after wholesale order completion" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                    </div>
                </div>

                <div class="bug-card">
                    <h4>BUG-021: Activity History No Longer Logs Any Events After Fix <span class="severity high">High</span></h4>
                    <p><strong>Location:</strong> Admin → History → Activity History</p>
                    <p><strong>Steps:</strong> After the recent fixes, perform various actions that should create history entries (Sales Out, Stock In, product updates, wholesale orders, deletions) → Go to <em>History</em> and check the Activity History list for all branches, all actions, and all users.</p>
                    <p><strong>Expected:</strong> Every relevant action (sales, stock movements, product updates, deletions, etc.) should appear in Activity History, filtered appropriately by branch, action, and user.</p>
                    <p><strong>Actual:</strong> Activity History shows &quot;No activity logs found&quot; and remains empty even after performing multiple actions that previously created entries. No sales out, stock in, updates, wholesale orders, or deletions are logged.</p>
                    <p><strong>Impact:</strong> Completely breaks auditability—admins lose visibility into who changed what and when, across all branches and actions. This makes it hard to investigate issues, reconcile inventory, or review staff activity.</p>
                    <p><strong>Recommendation:</strong> Investigate the recent changes to the logging logic or backend that may have disabled history writes. Restore event logging for all relevant flows and add automated tests to ensure future fixes cannot silently stop Activity History from recording entries.</p>
                    <p style="margin-top: 10px;"><strong>Preview:</strong> History screen showing an empty Activity History list with &quot;No activity logs found&quot; despite recent operations.</p>
                    <div style="display: flex; justify-content: center; margin-top: 6px;">
                        <div style="flex: 1 1 260px; max-width: 560px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">History &rarr; Activity History showing no logs after performing sales, stock, and update actions</p>
                            <img class="report-img" src="sc/history_error.png" alt="Activity History view showing No activity logs found even after multiple actions" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                    </div>
                </div>

                <div class="bug-card minor">
                    <h4>BUG-022: Product Allows Cost Higher Than Selling Price (Negative Profit) <span class="severity medium">Medium</span></h4>
                    <p><strong>Location:</strong> Admin / Manager → Inventory → Add Product (and Edit Product)</p>
                    <p><strong>Steps:</strong> Add or edit a product so that <em>Cost</em> is higher than <em>Retail Price</em> and/or <em>Wholesale Price</em> → Save the product → Observe profit calculations/indicators where applicable.</p>
                    <p><strong>Expected:</strong> The system should prevent obvious invalid pricing that results in negative profit (e.g., block save with validation), or at minimum warn the user and require explicit confirmation (since it can be a data-entry mistake).</p>
                    <p><strong>Actual:</strong> The form allows saving a product with cost higher than selling price, resulting in negative profit values.</p>
                    <p><strong>Impact:</strong> Can silently introduce pricing/data errors that make the business appear to lose money on items unintentionally, and can skew profit reporting and decision-making.</p>
                    <p><strong>Recommendation:</strong> Add validation or warning: require Retail/Wholesale to be ≥ Cost (or allow override with confirmation and reason). Also highlight negative-profit products in the UI so they’re easy to catch and correct.</p>
                    <p style="margin-top: 10px;"><strong>Preview:</strong> Example of a product configuration that yields negative profit due to cost exceeding selling price.</p>
                    <div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: center; margin-top: 6px;">
                        <div style="flex: 1 1 260px; max-width: 360px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">1. Product pricing setup (cost higher than price)</p>
                            <img class="report-img" src="sc/negative_branch.png" alt="Example showing product cost higher than retail/wholesale price" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                        <div style="flex: 1 1 260px; max-width: 360px;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 4px; text-align: center;">2. Negative profit result</p>
                            <img class="report-img" src="sc/negative_branch2.png" alt="Example showing negative profit due to cost exceeding selling price" style="width: 100%; border-radius: 6px; box-shadow: 0 1px 4px rgba(0,0,0,0.1);" title="Click to enlarge" />
                        </div>
                    </div>
                </div>
                <!-- Add additional bug cards here as you test in this cycle -->
            </div>
        </div>

        <!-- Recommendations (this cycle) -->
        <div class="section">
            <div class="section-header" onclick="toggleSection(this)">
                <h2>Recommendations (Post-Fix Regression)</h2>
                <svg class="chevron" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
            </div>
            <div class="section-content">
                <p style="font-size: 13px; color: #4a5568; margin-bottom: 10px;">
                    Capture any final UX or reporting improvements you notice while re-testing fixed areas. Reference BUG IDs and
                    attach screenshots as needed.
                </p>
                <ol style="padding-left: 20px; line-height: 2;">
                    <li>
                        <strong>Recommendation:</strong> In the Inventory list, add a visible <em>Cost</em> column alongside Stock, Retail Price, Wholesale Price, and Profit/Unit so admins can quickly see cost, selling prices, and profit margin per product without opening the edit modal.
                        <div style="margin-top: 12px; text-align: center;">
                            <p style="font-size: 12px; color: #4a5568; margin-bottom: 6px;"><strong>Illustration:</strong> Inventory table where a Cost column would help compare cost vs. selling prices and profit/unit at a glance.</p>
                            <img class="report-img" src="sc/cost_column.png" alt="Inventory list showing product, category, stock, retail, wholesale and profit per unit, with space for a Cost column" style="max-width: 420px; width: 100%; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);" title="Click to enlarge" />
                        </div>
                    </li>
                </ol>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p> MotorParts Inventory & POS System v1.0</p>
            <p>Page 3 – Regression and follow-up QA after second round of fixes.</p>
        </div>
    </div>
    
    <!-- Lightbox for image preview -->
    <div class="lightbox-overlay" id="lightbox" onclick="if(event.target===this) closeLightbox();">
        <span class="lightbox-close" onclick="closeLightbox();" aria-label="Close">&times;</span>
        <img src="" alt="" id="lightbox-img" onclick="event.stopPropagation();" />
    </div>
    
    <script>
        function toggleSection(header) {
            header.classList.toggle('open');
            const content = header.nextElementSibling;
            content.classList.toggle('active');
        }
        function openLightbox(src, alt) {
            var lb = document.getElementById('lightbox');
            var img = document.getElementById('lightbox-img');
            img.src = src;
            img.alt = alt || '';
            lb.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            document.body.style.overflow = '';
        }
        document.querySelectorAll('.report-img').forEach(function(el) {
            el.addEventListener('click', function() { openLightbox(this.src, this.alt); });
        });
        document.addEventListener('keydown', function(e) { if (e.key === 'Escape') closeLightbox(); });
    </script>
</body>
</html>
